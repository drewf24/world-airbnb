---
title: "NYC Airbnnb Popularity Factors"
author: "WORLD"
date: "12/15/2019"
output: github_document
---
     

### Load packages & data 

```{r load-packages, message=FALSE}
library(tidyverse) 
library(infer)
library(openintro)
library(dplyr)
library(knitr)
library(broom)
```

Uploaded the Airbnb data set from Kaggle via a csv file:

```{r load-data, message=FALSE}
abnb <- read_csv("AB_NYC_2019.csv")
```

Assuming that the data we have for Airbnbs in New York City represents the population. In order to perform the following analysis we used sample_n to randomly select 31 sample observations.

In part I, the following research question will be examined: How does location (borough and neighborhood, for example) influence the price of a listing?

In part II, the following research question will be examined: How does the way in which a property is listed (type of room, for example) influence the availability of a listing?

### Part A

Creating the sample that we will perform the following analysis on:

```{r abnb_sample}
set.seed(111519)
abnb_sample <- sample_n(abnb, 50)
```

Constructing a bootstrap distribution for the median price of Airbnbs in NYC:

```{r diff_med_income_boot_dist}
boot_dist_median_price <- abnb_sample %>%
  specify(response = price) %>%
  generate(reps = 1000, type = "bootstrap") %>%
  calculate(stat = "median")
```

Creating a 95% bootstrap confidence interval for the the median price of Airbnbs in NYC:

```{r boot_dist_median_priceci}
set.seed(111519)
(ci_bounds <- get_ci(boot_dist_median_price, level= 0.95))
```

We are 95% confident that the population median price per night of Airbnbs in NYC is between $97.50 and $147.51.

Creating a visualizaing of the bootstrap distribution for median price:

```{r boot_dist_median_vis}
visualize(boot_dist_median_price) + 
  labs(title = "Bootstrap Dist of Median Price") +
  shade_ci(ci_bounds)
```

### Part B

Using fct_relevel to make Manhattan the baseline level for neighbourhood_group:

```{r mutate-neighbourhood_group}
abnb_sample <- abnb_sample %>%
  mutate(neighbourhood_group = fct_relevel(neighbourhood_group, 
                                           "Manhattan", 
                                           "Brooklyn",
                                           "Staten Island",
                                           "Queens",
                                           "Bronx"))
```

Creating a linear model to predict Airbnb price by neighbourhood_group:

```{r lm-price-borough}
lm_price_borough <- lm(price ~ neighbourhood_group, data = abnb_sample)

lm_price_borough %>% 
  tidy() %>% 
  select(term, estimate) %>%
  kable(format = "markdown", digits =3)

```

The linear model is:

`price-hat = 180.333 -63.000*(neighbourhood_groupBrooklyn) +80.333*(neighbourhood_groupStaten Island) -71.667*(neighbourhood_groupQueens) -125.333(neighbourhood_groupBronx)`

Intepreting the intercept:

Given that a teaching professor has an average attractiveness of 0, their expected professor evaluation, on average, is 3.982 out of 5. In this case, the intercept does not have a meaningful interpretation because a student could not rate their professor a 0. The least they could rate their professor is a 1.

Interpreting the slopes using m_bty_rank linear model:

For each additional point rating increase in the attractiveness scale (out of 10), the average professor evaluation is expected to increase, on average, by 0.068 rating points (out of 5), holding all else constant.

Professors on the tenure track are expected to have, on average, an average professor evaluation score which is 0.161 rating points lower (out of 5) than the average professor rating of teaching professors, holding all else constant.

Tenured professors are expected to have, on average, an average professor evaluation score which is 0.126 rating points lower (out of 5) than the average professor rating of teaching professors, holding all else constant.


### Part C

```{r ellie}
abnb_sample <- abnb_sample %>%
   mutate(price_median = median(price), 
          price = case_when(
      price > price_median ~ "Above",
      price < price_median ~ "Below"
    ))
```

We will now perform a hypothesis test to determine if there is a difference in the true median prices between Manhattan and Brooklyn.

We will set our alpha level of 5%.

m1 = median price of Manhattan
m2 = median price of Brooklyn

Null Hypothesis: There is no difference between the median prices between Manhattan and Brooklyn.
Ho: m1 - m2 = 0

Alternative Hypothesis: There is a difference between the median prices between Manhattan and Brooklyn.
Ha: m1 - m2 != 0

```{r hypothesis-test}

```

If the p-value is greater than our predetermined alpha level of 0.05, then we fail to reject the null hypothesis and cannot conlude that there is a statistically significant difference between the median prices of Manhattan and Brooklyn.

If the p-value is less than our predetermined alpha level of 0.05, then we reject the null hypothesis and have convincing evidence to conclude that there is a statistically significant difference bteween the median prices of Manhattan and Brooklyn.


### Part D
>>>>>>> f0dd0b9fae3b746538aec0d22f731995da201782

Second research question: How does the way in which a property is listed (type of room, for example) influence the availability of a listing?
